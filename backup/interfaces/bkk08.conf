# network interface settings; autogenerated
# Please do NOT modify this file directly, unless you know what
# you're doing.
#
# If you want to manage parts of the network configuration manually,
# please utilize the 'source' or 'source-directory' directives to do
# so.
# PVE will preserve these directives, but will NOT read its network
# configuration from sourced files, so do not attempt to move any of
# the PVE managed interfaces into external files!

source /etc/network/interfaces.d/*

auto lo
iface lo inet loopback
    # IPv6 primary loopback
    #up ip -6 addr add 2401:a860:181::8/128 dev lo
    #RouterId
    up ip -6 addr add fd00:155:255::8/128 dev lo
    # IPv4 legacy loopback
    #up ip addr add 160.22.181.8/32 dev lo
    #up ip addr add 160.22.181.181/32 dev lo
    #RouterId
    up ip addr add 10.155.255.8/32 dev lo
    # anycast for loadbalancer
    up ip addr add 160.22.181.81/32 dev lo

iface eno2 inet manual
iface eno2 inet6 manual


auto vmbr0
iface vmbr0 inet static
	address 192.168.69.218/16
	gateway 192.168.69.1
	netmask 255.255.0.0
	bridge-ports eno2
	bridge-stp off
	bridge-fd 0

#bkk10
# auto eno1
iface eno1 inet manual

# auto enp193s0f0np0
iface enp193s0f0np0 inet manual

#bkk40
# auto enp193s0f1np1
iface enp193s0f1np1 inet manual

# LACP bond of both trunks
auto bond0
iface bond0 inet manual
    bond-slaves    enp193s0f1np1 eno1
    bond-mode      802.3ad
    bond-miimon    100
    bond-lacp-rate fast
    mtu            9000

# QinQ outer‐400 on the bond
auto bond0.400
iface bond0.400 inet manual
    vlan-raw-device bond0
    vlan-id          400
    mtu              9000

# inner‐108
auto vlan108
iface vlan108 inet static
    vlan-raw-device bond0.400
    vlan-id          108
    mtu              1500
    #address          10.155.108.1/31

# inner‐208
auto vlan208
iface vlan208 inet static
    vlan-raw-device bond0.400
    vlan-id          208
    mtu              1500
    #address          10.155.208.1/31

# Internal services bridge (IPv6 primary)
auto vmbr1
iface vmbr1 inet6 static
    #address 2401:a860:8::1/64
    bridge-ports none
    bridge-stp off
    bridge-fd 0
    accept_ra 0
    autoconf 0
    # IPv6 routing for internal subnets
    #post-up ip -6 route add 2401:a860:8::/48 dev vmbr1

iface vmbr1 inet static
    address 10.8.0.1/24

# Public services bridge (Q-in-Q terminated)
auto vmbr2
iface vmbr2 inet6 manual
    bridge-ports vlan208 vlan108
    bridge-stp off
    bridge-fd 0
    address 10.155.108.1/31
    address 10.155.208.1/31
    mtu 1500

iface vmbr2 inet6 static
    address fd00:155:108::1/127
    address fd00:155:208::1/127
    # Public IPs assigned to lo, not bridge
    # BGP will handle routing

#iface enp193s0f0np0 inet manual

#iface enp193s0f1np1 inet manual

iface enxb03af2b6059f inet manual
